# -*- coding: utf-8 -*-
"""pkl_file_prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1VI8nGAX38NsJ62oV75dfvz9OJ9ULHA7e
"""



from google.colab import drive
drive.mount('/content/drive')

import joblib
from tensorflow.keras.preprocessing import image
import numpy as np
import os
import matplotlib.pyplot as plt

# Load the model from the .pkl file
model = joblib.load('/content/drive/MyDrive/MINI project Sem VI/model.pkl')

# Path to the directory containing test images
test_dir = '/content/drive/MyDrive/MINI project Sem VI/test'

# Iterate over the images in the test directory
for img_name in os.listdir(test_dir):
    img_path = os.path.join(test_dir, img_name)
    if os.path.isdir(img_path):
        continue

    # Load and preprocess the image
    img = image.load_img(img_path, target_size=(600,600))
    img_array = image.img_to_array(img)
    img_array = np.expand_dims(img_array, axis=0)

    # Make prediction using the loaded model
    prediction = model.predict(img_array)

    # Print the result
    if prediction >= 0.5:
        print(f'The image {img_name} is Real')
    else:
        print(f'The image {img_name} is Fake')

    # Display the image
    plt.imshow(img)
    plt.axis('off')
    plt.show()